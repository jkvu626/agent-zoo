# 02.5 — Agent Creator spec (COMPLETE)

> **STATUS: COMPLETE**
>
> All functionality implemented: + button, inline creator form, live sprite preview, API integration.
>
> **Note:** `docs/FRONTEND-LAYOUT.md` states "No 'add agent' in the app—agents appear when they connect." This contradicts the implemented feature. The docs should be updated to reflect that agents can now be manually created in the webapp.

**Scope:** Add a character creator to the left sidebar. Users click a + button in the sidebar header to open an inline creator form with a live-morphing sprite preview. The creator uses only a name field; personality is edited later via the Soul button.

**References:** `packages/webapp/src/components/layout/LeftSidebar.tsx`, `packages/webapp/src/components/agent/AgentSprite.tsx`, `packages/webapp/src/api/hooks.ts`.

---

## 1. Goals

- Add a + button to the Agents sidebar header.
- Show an inline character creator when clicked (replaces agent list with animation).
- Display a live-morphing sprite preview that changes as the user types.
- Create agents with name only (simple, focused flow).
- Navigate to new agent after successful creation.

---

## 2. UI Flow

**List View** → **Creator View**

```
+---------------------------+   +---------------------------+
| Agents             [+]   |   | <- New Agent              |
+---------------------------+   +---------------------------+
|  Agent 1                  |   |                           |
|  Agent 2                  |   |   [Preview Sprite]        |
|  Agent 3                  |   |   (animated, morphing)    |
|                           |   |                           |
|                           |   |  Name *                   |
|                           |   |  [________________]       |
|                           |   |                           |
+---------------------------+   +---------------------------+
                                | [Cancel]      [Create]    |
                                +---------------------------+
```

---

## 3. Files to modify

### `packages/webapp/src/components/layout/LeftSidebar.tsx`

- Add local state: `useState<"list" | "creator">("list")`.
- Add IconButton with + icon in header (right side of "Agents" title).
- Wrap content in AnimatePresence for smooth view transitions.
- Conditionally render AgentList or AgentCreator based on view state.

### New: `packages/webapp/src/components/agent/AgentCreator.tsx`

Main form component:

- **Header:** Back arrow button + "New Agent" title.
- **Preview:** Live-morphing sprite using AgentSprite:
  - Create preview Agent with `id`: `name.toLowerCase().replace(/\s+/g, '-')`.
  - `generateAppearance()` deterministically selects color, eyes, mouth, accessory, tail based on name hash.
  - Creates "discovery" mechanic — different names = different creatures.
- **Form:** Single name input field with placeholder "Give your agent a name...".
- **Footer:** Cancel and Create buttons.
- Uses `useCreateAgent()` hook from existing API.
- On success: navigates to `/agent/{id}` and resets to list view.

### New: `packages/webapp/src/components/icons/PlusIcon.tsx`

Simple SVG plus icon for the add button.

---

## 4. State management

- Local view state in LeftSidebar (no global state needed).
- Single name state in AgentCreator component.
- Uses existing `useCreateAgent()` React Query hook for mutation.

---

## 5. Animation strategy

- **View transition:** AnimatePresence with `mode="wait"`:
  - List exits with opacity: 0, x: -16.
  - Creator enters with opacity: 0, x: 16.
  - Use `springSmooth` from `theme/motion.ts`.
- **Preview sprite:** Gentle bounce animation (existing idle pattern).
- **Form fields:** Staggered fade-in for cozy feel.

---

## 6. Design polish

- Playful placeholder: "Give your agent a name...".
- Warm orange accent for Create button (primary variant).
- Smooth rounded input matching SoulEditor styling.
- Discovery mechanic encourages name experimentation.
- Gentle bounce on preview sprite.

---

## 7. Out of scope

- Personality field (edited via Soul button after creation).
- Custom appearance picker (procedural generation only).
- Validation beyond empty name check.
